<!DOCTYPE html>
<html lang="zh" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>保护地球 · 从我做起</title>
    <meta name="description" content="让我们共同行动，保护我们唯一的家园——地球。">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        .hero-bg {
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?ixlib=rb-4.0.3&auto=format&fit=crop&q=80') no-repeat center center/cover;
        }
        #map { height: 600px; width: 100%; border-radius: 1rem; }
        .stat-number { font-size: 3.5rem; font-weight: bold; color: #10b981; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .leaflet-popup-content { text-align: center; font-size: 1.1rem; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- 英雄区 -->
    <header class="hero-bg text-white py-40">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-5xl md:text-7xl font-bold mb-8">保护地球<br>从我做起</h1>
            <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto opacity-90">
                我们只有一个地球。<br>每一次选择，都在影响我们的未来。
            </p>
            <a href="#map-section" class="bg-green-500 text-white px-10 py-4 rounded-full text-lg font-semibold hover:bg-green-600 transition">
                查看全球污染地图 →
            </a>
        </div>
    </header>

    <!-- 导航 -->
    <nav class="sticky top-0 bg-white shadow-lg z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-center space-x-10 text-lg font-medium">
                <a href="#problem" class="hover:text-green-600 transition">环境危机</a>
                <a href="#map-section" class="hover:text-green-600 transition">污染地图</a>
                <a href="#actions" class="hover:text-green-600 transition">如何行动</a>
                <a href="#facts" class="hover:text-green-600 transition">数据说话</a>
                <a href="#join" class="hover:text-green-600 transition">加入我们</a>
            </div>
        </div>
    </nav>

    <!-- 新增：互动污染地图 -->
    <section id="map-section" class="py-24 bg-gray-100">
        <div class="container mx-auto px-6 max-w-7xl">
            <h2 class="text-4xl font-bold text-center mb-12">全球实时空气质量地图</h2>
            <p class="text-center text-lg text-gray-600 mb-10">
                点击标记查看城市当前 AQI（空气质量指数）。颜色越红表示污染越严重。
            </p>
            <div id="map" class="shadow-2xl"></div>
            <p class="text-center text-sm text-gray-500 mt-4">
                数据来源：World Air Quality Index 项目（<a href="https://waqi.info" target="_blank" class="underline">waqi.info</a>）
            </p>
        </div>
    </section>

    <!-- 其他原有部分（略微精简展示） -->
    <section id="problem" class="py-24 bg-white"> <!-- 同之前内容 --> </section>
    <section id="actions" class="py-24 bg-green-50"> <!-- 同之前内容 --> </section>
    <section id="facts" class="py-24 bg-gray-100"> <!-- 同之前内容 --> </section>
    <section id="join" class="py-32 bg-gradient-to-r from-green-600 to-teal-600 text-white"> <!-- 同之前内容 --> </section>

    <!-- 页脚 -->
    <footer class="bg-gray-900 text-gray-400 py-10 text-center">
        <p class="mb-4">保护地球 · 人人有责</p>
        <p>&copy; 2026 保护地球公益页面 | 为了更美好的明天</p>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // 初始化地图
        const map = L.map('map').setView([20, 0], 2); // 全球视角

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // AQI 颜色函数
        function getColor(aqi) {
            if (aqi <= 50) return '#00e400';   // 绿色 - 良好
            if (aqi <= 100) return '#ffff00';  // 黄色
            if (aqi <= 150) return '#ff7e00';  // 橙色
            if (aqi <= 200) return '#ff0000';  // 红色
            if (aqi <= 300) return '#8f3f97';  // 紫色
            return '#7e0023'; // 褐红色 - 危险
        }

        // 主要城市列表（可随意扩展）
        const cities = [
            {name: "北京", lat: 39.9042, lng: 116.4074},
            {name: "上海", lat: 31.2304, lng: 121.4737},
            {name: "德里", lat: 28.7041, lng: 77.1025},
            {name: "洛杉矶", lat: 34.0522, lng: -118.2437},
            {name: "伦敦", lat: 51.5074, lng: -0.1278},
            {name: "巴黎", lat: 48.8566, lng: 2.3522},
            {name: "东京", lat: 35.6762, lng: 139.6503},
            {name: "悉尼", lat: -33.8688, lng: 151.2093},
            {name: "莫斯科", lat: 55.7558, lng: 37.6173},
            {name: "开普敦", lat: -33.9249, lng: 18.4241},
            {name: "里约热内卢", lat: -22.9068, lng: -43.1729},
            {name: "纽约", lat: 40.7128, lng: -74.0060},
        ];

        // 批量获取 AQI 并添加标记
        cities.forEach(city => {
            fetch(`https://api.waqi.info/feed/geo:${city.lat};${city.lng}/?token=public`) // 公开 token，仅演示用
                .then(res => res.json())
                .then(data => {
                    if (data.status === "ok") {
                        const aqi = data.data.aqi;
                        const color = getColor(aqi);

                        const marker = L.circleMarker([city.lat, city.lng], {
                            radius: 12,
                            fillColor: color,
                            color: "#000",
                            weight: 1,
                            opacity: 1,
                            fillOpacity: 0.8
                        }).addTo(map);

                        marker.bindPopup(`
                            <b>${city.name}</b><br>
                            AQI: <b style="color:${color}">${aqi}</b><br>
                            更新时间: ${new Date(data.data.time.s).toLocaleString()}
                        `);
                    }
                })
                .catch(() => {
                    // 如果请求失败，添加灰色标记
                    L.circleMarker([city.lat, city.lng], {
                        radius: 8,
                        fillColor: "#888",
                        fillOpacity: 0.6
                    }).addTo(map).bindPopup(`<b>${city.name}</b><br>数据暂不可用`);
                });
        });
    </script>
</body>
</html>
